"use strict";function initList(){allMySights=[];for(var e=0;e<mySights.length;e+=3)allMySights.push({nameofsight:mySights[e],visible:!0})}function getWikipediaInfo(e){var i="https://en.wikipedia.org/w/api.php?action=opensearch&search="+e+"&format=json&callback=wikiCallback";$.ajax(i,{dataType:"jsonp",success:function(e){var i=e[1];$("#sight-info").empty(),$("#sight-info-header").empty().append("Information from Wikipedia");for(var n=0;n<i.length;n++){var a=i[n],r="http://en.wikipedia.org/wiki/"+a;$("#sight-info").append('<li><a target="_blank" href="'+r+'">'+a+"</a></li>")}},error:function(e){$("#sight-info-header").empty().append("Information from Wikipedia could not be loaded")}})}var map,infowindow,allMySights=[],allMyMarkers=[],infoWindowContentString="<div><h5 id='sight-info-header'></h5><ul class='list-unstyled' id='sight-info'></ul></div>",mySights=["Centre Pompidou",48.8606,2.3522,"Tour Eiffel",48.8583,2.2944,"Arc de Triomphe",48.8731545,2.2949929,"Musee Rodin",48.8553,2.316,"Musee d'Orsay",48.8599,2.3265,"Musee du Louvre",48.8606,2.3376,"Notre-Dame de Paris",48.8529,2.3499,"Jardin du Luxembourg",48.8462,2.3371],MapModule=function(){return{initMap:function(){if("undefined"!=typeof google){var e=new google.maps.Map(document.getElementById("map-area"),{center:{lat:48.8606,lng:2.3522},zoom:14});if(window.addEventListener("resize",function(i){e.fitBounds(window.mapBounds)}),window.mapBounds=new google.maps.LatLngBounds,"undefined"!=typeof e){for(var i=function(i,n,a){var r=window.mapBounds,o=new google.maps.Marker({position:{lat:n,lng:a},title:i,visible:!0,map:e});return infowindow=new google.maps.InfoWindow({content:infoWindowContentString}),google.maps.event.addListener(infowindow,"closeclick",function(){for(var i=0;i<allMyMarkers.length;i++)allMyMarkers[i].marker.setAnimation(null);e.fitBounds(window.mapBounds)}),r.extend(new google.maps.LatLng(n,a)),e.fitBounds(r),e.setCenter(r.getCenter()),google.maps.event.addListener(o,"click",function(){for(var i=0;i<allMyMarkers.length;i++)allMyMarkers[i].marker.setAnimation(null),allMyMarkers[i].infowindow.close();e.setCenter(o.getPosition()),infowindow.open(e,o),null!==o.getAnimation()?o.setAnimation(null):(getWikipediaInfo(o.title),o.setAnimation(google.maps.Animation.BOUNCE))}),{marker:o,infowindow:infowindow}},n=0;n<mySights.length;n+=3){var a=i(mySights[n],mySights[n+1],mySights[n+2]);allMyMarkers.push({name:mySights[n],marker:a.marker,infowindow:a.infowindow})}var r=function(){var i=this;i.sightarr=ko.observableArray(allMySights),i.searchStr=ko.observable(""),i.entryClicked=function(i){getWikipediaInfo(i.nameofsight);for(var n=0;n<allMyMarkers.length;n++)if(i.nameofsight===allMyMarkers[n].name){for(var a=0;a<allMyMarkers.length;a++)allMyMarkers[a].marker.setAnimation(null),allMyMarkers[a].infowindow.close();e.setCenter(allMyMarkers[n].marker.getPosition()),allMyMarkers[n].marker.setAnimation(google.maps.Animation.BOUNCE),allMyMarkers[n].infowindow.open(e,allMyMarkers[n].marker)}},i.filterSights=function(){for(var n=0;n<allMySights.length;n++)""!==i.searchStr()&&(allMySights[n].nameofsight.toLowerCase().includes(i.searchStr())&&allMySights[n].visible===!0?allMyMarkers[n].marker.setVisible(!0):(allMySights[n].visible=!1,allMyMarkers[n].marker.setVisible(!1)));if(""===i.searchStr()){for(i.sightarr.removeAll(),initList(),n=0;n<allMySights.length;n++)i.sightarr.push(allMySights[n]);for(var a=0;a<allMyMarkers.length;a++)allMyMarkers[a].marker.setAnimation(null),allMyMarkers[a].marker.setVisible(!0),allMyMarkers[a].infowindow.close();e.fitBounds(window.mapBounds)}else{i.sightarr.remove(function(e){return e.visible===!1}),e.fitBounds(window.mapBounds);for(var a=0;a<allMyMarkers.length;a++)allMyMarkers[a].marker.setAnimation(null),allMyMarkers[a].infowindow.close()}i.searchStr("")}};initList(),ko.applyBindings(new r)}}},initMapError:function(){window.alert("Map could not be initialized")}}}();