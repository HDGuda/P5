"use strict";var map,infowindow,allMySights=[],allMyMarkers=[],infoWindowContentString="<div><h5 id='sight-info-header'></h5><ul class='list-unstyled' id='sight-info'></ul></div>",mySights=["Centre Pompidou",48.8606,2.3522,"Tour Eiffel",48.8583,2.2944,"Arc de Triomphe",48.8731545,2.2949929,"Paris Expo Porte de Versailles",48.8296,2.2872075,"Musee Rodin",48.8553,2.316,"Musee d'Orsay",48.8599,2.3265,"Musee du Louvre",48.8606,2.3376,"Notre-Dame de Paris",48.8529,2.3499,"Jardin du Luxembourg",48.8462,2.3371],ListModule=function(){return{initList:function(){for(var e=0;e<mySights.length;e+=3)allMySights.push({nameofsight:mySights[e],visible:!0})},getWikipediaInfo:function(e){var i="https://en.wikipedia.org/w/api.php?action=opensearch&search="+e+"&format=json&callback=wikiCallback";$.ajax(i,{dataType:"jsonp",success:function(e){var i=e[1];$("#sight-info").empty(),$("#sight-info-header").empty().append("Information from Wikipedia");for(var a=0;a<i.length;a++){var n=i[a],o="http://en.wikipedia.org/wiki/"+n;$("#sight-info").append('<li><a target="_blank" href="'+o+'">'+n+"</a></li>")}},error:function(e){$("#sight-info-header").empty().append("Information from Wikipedia could not be loaded")}})}}}(),MapModule=function(){return{initializeMap:function(){var e={disableDefaultUI:!1,fullscreenControl:!1,scrollwheel:!1,zoom:2,draggable:!1};map=new google.maps.Map(document.querySelector("#map-area"),e),null===map&&window.alert("Map could not be initialized"),window.addEventListener("resize",function(e){map.fitBounds(mapBounds)}),window.mapBounds=new google.maps.LatLngBounds},placeMarkers:function(){for(var e=0;e<mySights.length;e+=3){var i=MapModule.createMapMarker(mySights[e],mySights[e+1],mySights[e+2]);allMyMarkers.push({name:mySights[e],marker:i.marker,infowindow:i.infowindow})}},createMapMarker:function(e,i,a){var n=window.mapBounds,o=new google.maps.Marker({map:map,position:{lat:i,lng:a},title:e,visible:!0});return infowindow=new google.maps.InfoWindow({content:infoWindowContentString}),n.extend(new google.maps.LatLng(i,a)),map.fitBounds(n),map.setCenter(n.getCenter()),google.maps.event.addListener(o,"click",function(){for(var e=0;e<allMyMarkers.length;e++)allMyMarkers[e].marker.setAnimation(null),allMyMarkers[e].infowindow.close();infowindow.open(map,o),null!==o.getAnimation()?o.setAnimation(null):(ListModule.getWikipediaInfo(o.title),o.setAnimation(google.maps.Animation.BOUNCE))}),{marker:o,infowindow:infowindow}}}}(),SightViewModel=function(e){var i=this;i.sightarr=ko.observableArray(e),i.searchStr=ko.observable(""),i.entryClicked=function(e){ListModule.getWikipediaInfo(e.nameofsight);for(var i=0;i<allMyMarkers.length;i++)if(e.nameofsight===allMyMarkers[i].name){for(var a=0;a<allMyMarkers.length;a++)allMyMarkers[a].marker.setAnimation(null),allMyMarkers[a].infowindow.close();allMyMarkers[i].marker.setAnimation(google.maps.Animation.BOUNCE),allMyMarkers[i].infowindow.open(map,allMyMarkers[i].marker)}},i.filterSights=function(){for(var e=0;e<allMySights.length;e++)""!==i.searchStr()&&(allMySights[e].nameofsight.includes(i.searchStr())?allMySights[e].visible=!0:allMySights[e].visible=!1);if(""===i.searchStr())for(allMySights=[],i.sightarr.removeAll(),ListModule.initList(),e=0;e<allMySights.length;e++)i.sightarr.push(allMySights[e]);else i.sightarr.remove(function(e){return e.visible===!1});i.searchStr("")}};window.addEventListener("load",MapModule.initializeMap()),MapModule.placeMarkers(),ListModule.initList(),ko.applyBindings(new SightViewModel(allMySights));